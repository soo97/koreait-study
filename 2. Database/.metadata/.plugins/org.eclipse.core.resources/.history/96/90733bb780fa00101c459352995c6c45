-- Q1. 사원의 사번(emp_no)과 급여(salary)를 함께 조회하세요.
SELECT emp_no, salary FROM salaries;
-- Q2. 사원의 사번(emp_no), 이름(first_name)과 부서 정보(dept_name)를 함께 조회하세요.
SELECT d.emp_no, em.first_name, de.dept_name
FROM dept_emp d
JOIN employees em
ON d.emp_no = em.emp_no
JOIN departments de
ON d.dept_no = de.dept_no;

-- Q3. 현재 재직 중인 사원의 이름(first_name)과 부서(dept_name)를 조회하세요.
SELECT em.first_name, de.dept_name
FROM dept_emp d
JOIN employees em
ON d.emp_no = em.emp_no
JOIN departments de
ON d.dept_no = de.dept_no;
-- Q4. 급여가 80000 이상인 사원의 이름(first_name)과 급여(salary)를 조회하세요. 
SELECT first_name, salary
FROM employees em
JOIN salaries s
ON em.emp_no = s.emp_no
WHERE salary >= 80000;
-- Q5. 사원의 이름(first_name)과 급여(salary)를 급여가 높은 순으로 조회하세요.
SELECT em.first_name, s.salary
FROM employees em
JOIN salaries s 
ON em.emp_no = s.emp_no ORDER BY salary desc;
-- Q6. 부서 이름(dept_name)과 부서별 사원 수(count)를 조회하세요.
SELECT dept_name, count(*) AS '사원 수'
from dept_emp de
JOIN departments d
ON de.dept_no = d.dept_no 
JOIN employees em
ON de.emp_no = em.emp_no GROUP BY dept_name;

-- Q7. 부서별 사원 수가 20000명 이상인 부서의 이름(dept_name)과 사원수(count)만 조회하세요.
SELECT dept_name, count(*) AS '사원 수'
FROM dept_emp de
JOIN departments d
ON de.dept_no = d.dept_no
JOIN employees em
ON de.emp_no = em.emp_no GROUP BY dept_name HAVING count(*) >= 20000;
-- Q8. 성별이 F인 사원의 이름(first_name)과 부서(dept_name)를 조회하세요.
SELECT em.first_name, de.dept_name
FROM dept_emp d
JOIN employees em
ON d.emp_no = em.emp_no
JOIN departments de
ON d.dept_no = de.dept_no WHERE gender = 'M';
-- Q9. 입사일이 1995년 이후인 사원의 이름(first_name)과 부서(dept_name)를 조회하세요.
SELECT em.first_name, de.dept_name,
FROM dept_emp d
JOIN employees em
ON d.emp_no = em.emp_no
JOIN departments de
ON d.dept_no = de.dept_no where hire_date >= '1995-01-01';
-- Q10. 부서 이름(dept_name)과 부서별 평균 급여(avg_salary)를 조회하세요.
SELECT dept_name, avg(salary) AS avg_salary
FROM dept_emp d
JOIN salaries s 
ON d.emp_no = s.emp_no
JOIN departments de
ON d.dept_no = de.dept_no  GROUP BY dept_name;
-- Q11. 현재 재직 중인 사원의 이름, 부서, 급여를 급여 내림차순으로 조회하세요.
SELECT em.first_name , de.dept_name, s.salary
FROM dept_emp d
JOIN employees em
ON d.emp_no = em.emp_no
JOIN departments de
ON d.dept_no = de.dept_no
JOIN salaries s
ON d.emp_no = s.emp_no ORDER BY s.salary desc;
-- Q12. 부서별 평균 급여가 70000 이상인 부서만 조회하세요.
SELECT de.dept_name
FROM dept_emp d
JOIN salaries s
ON d.emp_no = s.emp_no 
JOIN departments de
ON d.dept_no = de.dept_no GROUP BY de.dept_name HAVING avg(salary) >= 70000 ;
-- Q13. 직급별 사원 수를 조회하세요.
SELECT title, count(*) AS '사원 수'
FROM titles t
JOIN employees em
ON t.emp_no = em.emp_no GROUP BY title;
-- Q14. 급여 상위 사원의 이름, 직급, 급여를 조회하세요.
SELECT em.first_name, t.title, s.salary AS 상위급여
FROM salaries s 
JOIN employees em
ON s.emp_no = em.emp_no
JOIN titles t
ON s.emp_no = t.emp_no  having max(salary) GROUP BY emp_no LIMIT 3;
-- --------------------------------------------------------- LEFT JOIN
-- Q15. 모든 사원과 부서 정보를 조회하세요 (부서가 없어도 포함).
-- SELECT e.emp_no, e.first_name, d.dept_name
-- FROM employees e
-- LEFT JOIN dept_emp de ON e.emp_no = de.emp_no
-- LEFT JOIN departments d ON de.dept_no = d.dept_no;