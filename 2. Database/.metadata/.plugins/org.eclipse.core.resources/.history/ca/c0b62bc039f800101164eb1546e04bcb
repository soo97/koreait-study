-- 입사일이 1993년 2월 19일 이면서 생일 1964년 10월 24일 직원의 이름을 구하고
-- 다시 해당 이름으로 조건을 검색해서 사번(emp_no)를 구해야 하는 경우

SELECT first_name, last_name FROM employees
WHERE hire_date = '1993-02-19'
AND birth_date = '1964-10-24';

SELECT emp_no FROM employees
WHERE first_name = 'Conrado'
AND last_name = 'Serra';

-- 위의 쿼리를 서브쿼리를 이용하여 작성한 쿼리
SELECT emp_no FROM employees
WHERE first_name = (SELECT first_name FROM employees WHERE hire_date = '1993-02-19' AND birth_date = '1964-10-24')
AND last_name =(SELECT last_name FROM employees WHERE hire_date = '1993-02-19' AND birth_date = '1964-10-24');

SELECT emp_no
FROM employees
WHERE (first_name, last_name) = (SELECT first_name, last_name FROM employees WHERE hire_date = '1993-02-19' AND birth_date = '1964-10-24');

-- 직원중에서 emp_no가 가장 높은 직원 찾기
SELECT first_name, last_name
FROM employees
WHERE emp_no = (SELECT max(emp_no) FROM employees);


SELECT first_name, last_name
FROM employees
ORDER BY emp_no DESC
LIMIT 1;

SELECT first_name, last_name
FROM employees
WHERE hire_date = (SELECT min(hire_date) FROM employees);

-- 전체 평균보다 높은 연봉을 받는 직원 이름조회
SELECT first_name, last_name
FROM employees
WHERE emp_no = (SELECT * FROM salaries ORDER BY salary DESC LIMIT 1);
